
-- ======================================================================= 
-- TABLE hca_experiment
-- ======================================================================= 
-- 
-- experiment_id is generated by sequence
-- protocol can be null, to support exploration experiments (trial and error with no real protocol)
-- 

create table hca_experiment (
	experiment_id			number not null, 
	experiment_name			varchar2(100),
	experiment_dt			date, 
	experiment_user			varchar2(25),
	protocol_id				number, 
	description				varchar2(200),
	closed					number default 0,
	comments				varchar2(1600),
	multiplo_method			varchar2(100),
	multiplo_parameter		varchar2(100),
	archive_status			number default 0, 
	archive_user			varchar2(25),
	archive_dt				date
)
tablespace phaedra_d;

-- -----------------------------------------------------------------------
-- indexes
-- -----------------------------------------------------------------------

ALTER TABLE hca_experiment
	ADD CONSTRAINT hca_experiment_pk
		PRIMARY KEY  ( experiment_id ) 
		USING INDEX TABLESPACE phaedra_i;

ALTER TABLE hca_experiment
	ADD CONSTRAINT hca_experiment_fk_protocol
		FOREIGN KEY (protocol_id)
		REFERENCES hca_protocol(protocol_id);

CREATE INDEX hca_experiment_ix_01
	ON hca_experiment (experiment_dt)
	TABLESPACE phaedra_i;

CREATE INDEX hca_experiment_ix_02
	ON hca_experiment (protocol_id)
	TABLESPACE phaedra_i;
	
-- -----------------------------------------------------------------------
-- sequence
-- -----------------------------------------------------------------------

CREATE SEQUENCE hca_experiment_s
	INCREMENT BY 1
	START WITH 1
	NOMAXVALUE
	NOCYCLE
	NOCACHE;

-- -----------------------------------------------------------------------
-- grants
-- -----------------------------------------------------------------------

GRANT INSERT, UPDATE, DELETE ON hca_experiment to phaedra_role_crud;
GRANT SELECT ON  hca_experiment_s to phaedra_role_crud;
GRANT SELECT ON  hca_experiment to phaedra_role_read;
